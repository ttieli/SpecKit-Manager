在 AI 辅助的规范驱动开发（Spec-Driven Development, SDD）工作流中，`/speckit.specify` 命令是 **核心** 。它标志着项目开发的起点，旨在将瓶颈从编码速度转移到 **规范的清晰度** 。

`/speckit.specify` 的目的是 **定义您想要构建的内容（需求和用户故事）** ，而非技术实现方式。您的输入（Prompt）是 AI 代理（如 Claude Code 或 GitHub Copilot）生成详细、可执行规范（`spec.md`）的基础。

以下是关于** **`/speckit.specify` 的推荐写法和样例，重点在于如何构造**清晰、可测试且面向结果**的指令。

---

## 一、`/speckit.specify` 的核心原则（写什么）

Spec-Driven Development** ** **颠覆了传统流程** ：规范不再是文档，而是驱动代码生成的 **可执行工件** 。因此，您必须将意图表达得足够精确，使得机器能够执行它。

| 核心原则                             | 描述与强制要求                                                                                                                                      | 来源 |
| :----------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------- | :--- |
| **聚焦“是什么”和“为什么”** | 您的提示必须**明确**地描述用户需求、业务目标和期望结果（Outcome）。                                                                           |      |
| **绝对排除技术栈**             | 在此阶段，**严禁**提及实现方式、编程语言、API 结构或技术栈。技术决策应推迟到 `/plan` 阶段。                                                 |      |
| **捕捉用户旅程和边缘案例**     | 描述**用户旅程** （User Journey）和 **成功场景** （Acceptance Scenarios），并考虑到 **边缘案例** （Edge Cases）和潜在的错误场景。 |      |
| **遵守项目宪法**               | 您的规范（`spec.md`）必须与项目章程（Constitution）中定义的 **不可协商的原则** （例如代码质量和性能目标）保持一致。                         |      |

---

## 二、推荐的编写风格和结构化输入

AI 代理擅长模式补全，但不擅长 **读心术** 。因此，编写规范时应 **清晰、明确** ，仿佛在指导一位事无巨细、会严格遵循指令的初级开发人员。

### 1. 结构化描述要素

高质量的** **`/specify` 提示应包含以下结构化要素，以帮助 AI 生成完整的** **`spec.md` 文件：

| 结构化要素                         | 目的                                                                            | 示例（隐式或显式）                                           |
| :--------------------------------- | :------------------------------------------------------------------------------ | :----------------------------------------------------------- |
| **主要目标（Goal）**         | 应用程序的价值主张，解决了什么问题。                                            | “帮助求职者创建针对特定职位描述优化的简历”。               |
| **用户角色/权限**            | 谁会使用这个系统，以及他们能做什么（即使本阶段不实现登录）。                    | “五名预定义用户：一名产品经理，四名工程师”。               |
| **不可行（Out-of-Scope）**   | 明确排除某些功能，防止 AI**过度工程（over-eager）**或**臆想**功能。 | “**不**实现用户认证”；“**不**允许嵌套相册”。 |
| **关键实体（Key Entities）** | 提及主要的业务对象及其属性，但不涉及数据库字段或类型。                          | “费用记录（包含金额、日期、类别和描述）”。                 |
| **非功能性要求**             | 提及性能、安全、可扩展性等要求，但必须是**可衡量**的（如果此时已知）。    | “关键 API 响应时间低于 X 毫秒”（如果宪法中已定义）。       |

### 2. 强制性澄清（AI 的输出）

在您运行** **`/speckit.specify` 后，AI 代理会生成** **`spec.md` 文件，并在其中标记出需要澄清的**歧义**或 **缺失的决策点** 。

* **标记机制：** AI 会使用** **`[NEEDS CLARIFICATION: specific question]` 标记任何它需要进行猜测的地方。例如，它可能会标记：“系统必须通过 [NEEDS CLARIFICATION: 认证方式未指定 - 邮件/密码、SSO 还是 OAuth？] 进行用户认证”。
* **澄清步骤：** 在进入** **`/plan` 阶段之前，强烈推荐运行** **`/speckit.clarify` 命令。这个命令会通过结构化问答（最多 5 个有针对性的问题）来解决这些歧义，并将答案直接记录到** **`spec.md` 的** **`## Clarifications` 部分，从而降低返工风险。

---

## 三、`/speckit.specify` 样例

以下是基于 Spec Kit 最佳实践的两个功能规范的输入提示词示例。

### 样例 1：创建团队协作平台（Taskify）

这是一个**绿地项目（Greenfield）**的初始规范，重点在于业务流程和用户界面行为。

```
/speckit.specify 开发 Taskify，一个团队协作生产力平台。
目标：让用户能够创建项目，添加团队成员，分配任务，以及在看板（Kanban）板上移动任务和添加评论。

在初始阶段，我们将预定义五名用户：一名产品经理和四名工程师。应用不需要登录或密码。

用户流程：
1. 启动 Taskify 后，显示五名预定义用户的列表供用户选择。
2. 用户点击自己的名字后，进入主视图，显示项目列表。
3. 点击项目后，打开该项目的看板。
4. 看板应包含标准列："待办（To Do）"、"进行中（In Progress）"、"审核中（In Review）" 和 "完成（Done）"。
5. 用户可以拖放任务卡片以更改其状态。
6. 用户可以给任何任务卡片添加无限数量的评论。

关键要求：
- 当前登录用户被分配的任务卡片，必须以**不同颜色**高亮显示。
- 用户可以编辑和删除**自己**发表的评论，但**不能**编辑或删除其他用户的评论。
- 每个项目随机生成 5 到 15 个任务，确保每个状态列至少有一个任务。

不可行范围（Out-of-Scope）：
- 不实现用户登录或密码。
- 不集成任何第三方认证服务。
- 不实现项目创建/删除功能（仅使用预定义项目）。
```

**AI 生成的** **`spec.md` 预期输出要素：**

1. **用户场景（User Scenarios）：** 包含“以工程师身份进入应用并查看任务”等场景。
2. **功能需求（Functional Requirements）：** 包含** **`FR-XXX` 格式的条目，如** **`FR-004: 系统 MUST 允许用户编辑他们自己创建的评论`。
3. **澄清标记（Clarifications）：** AI 可能会生成：“任务卡片上的高亮颜色是 MUST be [NEEDS CLARIFICATION: 颜色代码或描述]？”（如果用户未明确指定）。

### 样例 2：为现有系统添加功能（Expense Tracking）

这是一个**棕地项目（Brownfield）**的迭代增强示例，重点在于功能边界和实体定义。

```
/speckit.specify 为现有应用添加“费用跟踪”功能。

核心目标是：用户能够记录、查看和删除个人费用。

用户必须能够为每条费用记录以下关键属性：
- 金额（Amount）
- 日期（Date）
- 类别（Category）
- 描述（Description）

要求：
- 仪表板必须显示“最近的费用”（Recent Expenses）。
- 费用记录必须支持至少 10 种预定义类别（如餐饮、差旅、住宿）。
- 金额字段必须支持最多两位小数且非负。

不可行范围（Out-of-Scope）：
- 不处理多用户共享费用。
- 不实现任何预算或报告功能，仅限基本 CRUD 操作。
- 类别必须是预定义的，用户不能创建新类别。
```

**AI 生成的** **`spec.md` 预期输出要素：**

1. **用户故事：** 包含“作为一名用户，我想要添加一条费用记录，以便追踪我的支出”。
2. **关键实体：** 明确定义费用记录（Expense Record）的属性。
3. **澄清标记：** AI 可能会提出针对模糊非功能需求的澄清问题：
   * `仪表板中的“最近的费用”是指 [NEEDS CLARIFICATION: 是指过去 30 天的记录，还是按时间顺序最近的 10 条记录？]`。
   * `当用户尝试删除一条费用记录时，系统是否 MUST [NEEDS CLARIFICATION: 要求二次确认或提供撤销选项？]`。
